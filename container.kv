#:import utils kivy.utils

<ScrollLabel@ScrollView>
    text: 'Консоль'
    scroll_type: ['bars', 'content']
    bar_width: 10
    Label:
        size_hint_y: None
        text_size: self.width, None
        height: self.texture_size[1]
        padding: 20, 20
        text: root.text
        color: utils.get_color_from_hex('#000000')

<ItemLabel@Label>
    font_size: '15sp'
    padding: 20, 20
    halign: 'left'
    valign: 'top'
    text_size: self.size
    multiline: True
    markup: True
    color: utils.get_color_from_hex('#000000')
    canvas.before:
        Color:
            rgba: utils.get_color_from_hex('#ffffff')
        Rectangle:
            pos: self.pos
            size: self.size

<InputLabel@Label>
    halign: 'left'
    valign: 'top'
    text_size: self.size
    multiline: True
    markup: True
    size_hint: .3, .4
    pos_hint: {'x':.02, 'y':.5}
    color: utils.get_color_from_hex('#000000')

<InputString@TextInput>
    multiline: True
    background_normal: 'white_pixel.png'
    background_active: 'white_pixel.png'
    size_hint: .66, .4
    pos_hint: {'x':.32, 'y':.5}

<CheckSaveButton@Button>
    size_hint: .3, .3
    pos_hint: {'x':.68, 'y':.1}
    text: 'Проверить/Сохранить'

<InputBlock@FloatLayout>
    padding: [5, 5, 5, 5]
    size_hint: 1, None
    height: 120
    text_label: ''
    input_string: ''
    button_name: ''
    input: input

    InputLabel:
        text: root.text_label

    InputString:
        id: input
        text: root.input_string

    CheckSaveButton:
        name: root.button_name
        on_release: app.root.handle_path(self.name)


<ScreenTemplate>
    main_screen: main_screen
    text_label: text_label

    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'

        FloatLayout:
            size_hint: 1, .1
            canvas:
                Color:
                    rgba: utils.get_color_from_hex('#999999')
                Rectangle:
                    pos: self.pos
                    size: self.size
            Label:
                id: text_label
                markup: True
                pos_hint: {'x':.025, 'y':0}
                size_hint: .3, .7
                text_size: self.size
                halign: 'center'

                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex('#bcbcbc')
                    Rectangle:
                        pos: self.pos
                        size: self.size
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'

            FloatLayout:
                id: main_screen
                size_hint: 1, .9
                canvas:
                    Color:
                        rgba: utils.get_color_from_hex('#999999')
                    Rectangle:
                        pos: self.pos
                        size: self.size

<SettingLayout>
    orientation: 'vertical'
    size_hint: .95, .975
    pos_hint: {'x':.025, 'y':.025}
    console: console
    save_dir_path: save_dir_path
    file_name: file_name
    images_path: images_path
    cell_color: cell_color
    update_file_name: update_file_name
    del_file_name: del_file_name
    canvas:
        Color:
            rgba: utils.get_color_from_hex('#bcbcbc')
        Rectangle:
            pos: self.pos
            size: self.size

    AnchorLayout:
        #pos_hint: {'x':0, 'y':0}
        anchor_x: 'center'
        anchor_y: 'center'
        size_hint: 1, .75

##############################################
        ScrollView:
            scroll_type: ['bars', 'content']
            size_hint: .96, .9
            bar_width: 10
            bar_color: utils.get_color_from_hex('#ffffff')
            bar_inactive_color: utils.get_color_from_hex('#eeeeee')

            GridLayout:
                cols: 1
                size_hint: 1, None
                height: self.minimum_height
                padding: 10, 10

                InputBlock:
                    id: save_dir_path
                    text_label: 'Путь к папке для хранения файлов:'
                    input_string: 'Введите путь к папке для хранения файлов.'
                    button_name: 'save_dir_path_button'

                InputBlock:
                    id: file_name
                    text_label: 'Имя файла для выгрузки таблицы:'
                    input_string: 'Введите имя файла (будет преобразованно к "имя_месяц_дата.xlsx").'
                    button_name: 'file_name_button'

                InputBlock:
                    id: images_path
                    text_label: 'Путь к папке с фото:'
                    input_string: 'Введите путь к папке с фото'
                    button_name: 'images_path_button'

                InputBlock:
                    id: cell_color
                    text_label: 'Цвет шрифта ячеек для удаления:'
                    input_string: 'Введите цвет шрифта ячеек для удаления'
                    button_name: 'cell_color_button'

                InputBlock:
                    id: update_file_name
                    text_label: 'Имя файла для загрузки данных в базу:'
                    input_string: 'Введите имя файла (будет преобразованно к "имя_месяц_дата.xlsx").'
                    button_name: 'update_file_name_button'

                InputBlock:
                    id: del_file_name
                    text_label: 'Имя файла для удаления данных из базы:'
                    input_string: 'Введите имя файла (будет преобразованно к "имя_месяц_дата.xlsx").'
                    button_name: 'del_file_name_button'

#########################################################
    AnchorLayout:
        #pos_hint: {'x':0, 'y':0}
        anchor_x: 'center'
        anchor_y: 'center'
        size_hint: 1, .25

        ItemLabel:
            id: console
            size_hint: .96, .85
            pos_hint: {'x':.02, 'y':.1}
            text: 'Консоль'

<LoadLayout>
    orientation: 'vertical'
    size_hint: .95, .975
    pos_hint: {'x':.025, 'y':.025}
    input: input
    console: console
    step_button_1: step_button_1
    step_button_2: step_button_2
    canvas:
        Color:
            rgba: utils.get_color_from_hex('#bcbcbc')
        Rectangle:
            pos: self.pos
            size: self.size

    AnchorLayout:
        size_hint: 1, .6
        anchor_x: 'center'
        anchor_y: 'center'
        BoxLayout:
            size_hint: .94, .94
            canvas:
                Color:
                    rgba: utils.get_color_from_hex('#ffffff')
                Rectangle:
                    pos: self.pos
                    size: self.size
            ScrollLabel:
                id: console

    AnchorLayout:
        size_hint: 1, .2
        anchor_x: 'center'
        anchor_y: 'center'

        TextInput:
            id: input
            size_hint: .94, .94
            padding: 20, 20
            multiline: True
            text: 'Поле ввода.'
            background_normal: 'white_pixel.png'
            background_active: 'white_pixel.png'

    AnchorLayout:
        size_hint: 1, .2
        anchor_x: 'center'
        anchor_y: 'center'

        BoxLayout:
            orientation: 'horizontal'
            size_hint: .6, .5
            Button:
                size_hint: .5, 1
                id: step_button_1
                text: 'Шаг 1'
                on_release: app.root.load_press_step(self.text)
            Button:
                size_hint: .5, 1
                id: step_button_2
                text: 'Шаг 4'
                on_release: app.root.load_press_step(self.text)

<HandleLayout>
    orientation: 'vertical'
    step_button: step_button
    size_hint: .95, .975
    pos_hint: {'x':.025, 'y':.025}
    console: console
    canvas:
        Color:
            rgba: utils.get_color_from_hex('#bcbcbc')
        Rectangle:
            pos: self.pos
            size: self.size

    AnchorLayout:
        size_hint: 1, .8
        anchor_x: 'center'
        anchor_y: 'center'

        ItemLabel:
            id: console
            size_hint: .94, .94
            text: 'Консоль'

    AnchorLayout:
        size_hint: 1, .2
        anchor_x: 'center'
        anchor_y: 'center'

        Button:
            size_hint: .6, .5
            id: step_button
            text: 'Шаг 1'
            on_release: app.root.handle_press_step(self.text)

<UploadLayout>
    orientation: 'vertical'
    size_hint: .95, .975
    pos_hint: {'x':.025, 'y':.025}
    console: console
    canvas:
        Color:
            rgba: utils.get_color_from_hex('#bcbcbc')
        Rectangle:
            pos: self.pos
            size: self.size

    AnchorLayout:
        size_hint: 1, .8
        anchor_x: 'center'
        anchor_y: 'center'

        ItemLabel:
            id: console
            size_hint: .94, .94
            text: 'Консоль'

    AnchorLayout:
        size_hint: 1, .2
        anchor_x: 'center'
        anchor_y: 'center'

        BoxLayout:
            orientation: 'horizontal'
            size_hint: .6, .5

            Button:
                size_hint: .5, 1
                text: 'Выгрузка'
                on_release: app.root.upload_step()

            Button:
                size_hint: .5, 1
                text: 'Удаление'
                on_release: app.root.delete_step()


<Container>
    _screen_manager: _screen_manager
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'

        NewScreenManager:
            size_hint: 1, .9
            id: _screen_manager


    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, .1

            Button:
                id : setting_button
                text: 'Настройки'
                on_release: _screen_manager.current = 'screen1'

            Button:
                id : load_button
                text: 'Загрузка'
                on_release: _screen_manager.current = 'screen2'

            Button:
                id : processing_button
                text: 'Обработка'
                on_release: _screen_manager.current = 'screen3'

            Button:
                id : upload_button
                text: 'Выгрузка'
                on_release: _screen_manager.current = 'screen4'